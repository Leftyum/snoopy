local uis = game:GetService("UserInputService")
local player = game.Players.LocalPlayer

-- Only run on mobile
if not uis.TouchEnabled then return end

-- Auto clicker logic
local running = false
local cps = 12
local dragging = false

-- GUI setup
local gui = Instance.new("ScreenGui")
gui.Name = "AutoClickerGUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- Main frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 150)
frame.Position = UDim2.new(1, -190, 0, 30)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = gui

-- Toggle button
local toggle = Instance.new("TextButton")
toggle.Size = UDim2.new(0, 160, 0, 40)
toggle.Position = UDim2.new(0, 10, 0, 10)
toggle.Text = "Auto Clicker OFF"
toggle.TextColor3 = Color3.new(1, 1, 1)
toggle.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
toggle.Font = Enum.Font.SourceSansBold
toggle.TextSize = 20
toggle.Parent = frame

-- CPS label
local cpsLabel = Instance.new("TextLabel")
cpsLabel.Size = UDim2.new(0, 160, 0, 20)
cpsLabel.Position = UDim2.new(0, 10, 0, 60)
cpsLabel.Text = "CPS: " .. cps
cpsLabel.TextColor3 = Color3.new(1, 1, 1)
cpsLabel.Font = Enum.Font.SourceSans
cpsLabel.TextSize = 18
cpsLabel.BackgroundTransparency = 1
cpsLabel.Parent = frame

-- Slider bar
local bar = Instance.new("Frame")
bar.Size = UDim2.new(0, 160, 0, 20)
bar.Position = UDim2.new(0, 10, 0, 90)
bar.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
bar.BorderSizePixel = 0
bar.Parent = frame

-- Slider knob
local knob = Instance.new("TextButton")
knob.Size = UDim2.new(0, 20, 1, 0)
knob.Position = UDim2.new(0, (cps/30)*140, 0, 0)
knob.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
knob.Text = ""
knob.AutoButtonColor = false
knob.Parent = bar

-- Show/Hide button
local toggleGUI = Instance.new("TextButton")
toggleGUI.Size = UDim2.new(0, 120, 0, 30)
toggleGUI.Position = UDim2.new(1, -130, 0, 0)
toggleGUI.Text = "Show Clicker"
toggleGUI.TextColor3 = Color3.new(1,1,1)
toggleGUI.Font = Enum.Font.SourceSansBold
toggleGUI.TextSize = 16
toggleGUI.BackgroundColor3 = Color3.fromRGB(30,30,30)
toggleGUI.Parent = gui

local guiVisible = true

toggleGUI.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch then
		guiVisible = not guiVisible
		frame.Visible = guiVisible
		toggleGUI.Text = guiVisible and "Hide Clicker" or "Show Clicker"
	end
end)

-- Drag slider to adjust CPS
knob.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
	end
end)

knob.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch then
		dragging = false
	end
end)

uis.TouchMoved:Connect(function(input)
	if dragging then
		local absPos = bar.AbsolutePosition.X
		local size = bar.AbsoluteSize.X
		local x = input.Position.X
		local relative = math.clamp(x - absPos, 0, size - knob.AbsoluteSize.X)
		knob.Position = UDim2.new(0, relative, 0, 0)
		local ratio = relative / (size - knob.AbsoluteSize.X)
		cps = math.clamp(math.floor(1 + (30 - 1) * ratio + 0.5), 1, 30)
		cpsLabel.Text = "CPS: " .. cps
	end
end)

-- Auto-click logic (tool:Activate)
local function autoClick()
	while running do
		local tool = player.Character and player.Character:FindFirstChildOfClass("Tool")
		if tool then
			pcall(function()
				tool:Activate()
			end)
		end
		task.wait(1 / cps)
	end
end

-- Toggle auto clicker
toggle.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch then
		running = not running
		toggle.Text = running and "Auto Clicker ON" or "Auto Clicker OFF"
		toggle.BackgroundColor3 = running and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
		if running then
			task.spawn(autoClick)
		end
	end
end)
